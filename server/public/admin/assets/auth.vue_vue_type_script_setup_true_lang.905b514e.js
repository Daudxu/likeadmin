import{B as M,V as N,D as O,E as q,F as H,L as I}from"./element-plus.81dd3128.js";import{a as U}from"./role.d904a3f6.js";import{s as W,t as j}from"./index.fd9b2e6e.js";import{P as z}from"./index.5e5e0158.js";import{d as G,s as m,r as c,a1 as J,o as v,c as Q,W as o,O as u,P as X,M as Y,a as k,n as y}from"./@vue.af680e04.js";const Z={class:"edit-popup"},se=G({__name:"auth",emits:["success","close"],setup($,{expose:C,emit:f}){const l=m(),_=m(),r=m(),x=c(!1),d=c(!0),i=c(!1),h=c([]),p=c([]),s=J({id:"",name:"",desc:"",sort:0,menu_id:[]}),g={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},b=()=>{i.value=!0,W({type:"menu"}).then(e=>{p.value=e,h.value=j(e),y(()=>{D()}),i.value=!1})},E=()=>{var a,n;const e=(a=l.value)==null?void 0:a.getCheckedKeys(),t=(n=l.value)==null?void 0:n.getHalfCheckedKeys();return e==null||e.unshift.apply(e,t),e},D=()=>{s.menu_id.forEach(e=>{y(()=>{var t;(t=l.value)==null||t.setChecked(e,!0,!1)})})},w=e=>{const t=p.value;for(let a=0;a<t.length;a++)l.value.store.nodesMap[t[a].id].expanded=e},F=e=>{var t,a;e?(t=l.value)==null||t.setCheckedKeys(h.value.map(n=>n.id)):(a=l.value)==null||a.setCheckedKeys([])},B=async()=>{var e,t;await((e=_.value)==null?void 0:e.validate()),s.menu_id=E(),await U(s),(t=r.value)==null||t.close(),f("success")},R=()=>{f("close")},A=()=>{var e;(e=r.value)==null||e.open()},K=async e=>{for(const t in s)e[t]!=null&&e[t]!=null&&(s[t]=e[t])};return b(),C({open:A,setFormData:K}),(e,t)=>{const a=M,n=N,V=O,S=q,T=H,L=I;return v(),Q("div",Z,[o(z,{ref_key:"popupRef",ref:r,title:"\u5206\u914D\u6743\u9650",async:!0,width:"550px",onConfirm:B,onClose:R},{default:u(()=>[X((v(),Y(T,{class:"ls-form",ref_key:"formRef",ref:_,rules:g,model:s,"label-width":"60px"},{default:u(()=>[o(S,{class:"h-[400px] sm:h-[600px]"},{default:u(()=>[o(V,{label:"\u6743\u9650",prop:"menu_id"},{default:u(()=>[k("div",null,[o(a,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:w}),o(a,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:F}),o(a,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=P=>d.value=P),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),k("div",null,[o(n,{ref_key:"treeRef",ref:l,data:p.value,props:{label:"name",children:"children"},"check-strictly":!d.value,"node-key":"id","default-expand-all":x.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1})]),_:1},8,["model"])),[[L,i.value]])]),_:1},512)])}}});export{se as _};
