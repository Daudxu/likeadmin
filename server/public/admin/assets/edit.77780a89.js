import{F as C}from"./index.319a77f2.js";import{a as U,c as x,d as N,e as T}from"./organization.836dafbb.js";import{d as q,r as f,k as L,l as R,N as S,m as $,n as z,e as d,z as H,o as D,c as M,a,w as s,i as u,y as O,g as j,O as G,H as I,f as J,h as K}from"./index.6235ba03.js";const P=J("div",{class:"muted"},"\u9ED8\u8BA4\u4E3A0\uFF0C \u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),Q=K("\u4FDD\u5B58"),ee=q({__name:"edit",setup(W){const v=f(null),{router:F,route:b}=L(),r=R(()=>{var t;return(t=b.query)==null?void 0:t.id}),c=f(!1),_=f([]),{formData:e,rules:B}=S($({formData:{pid:"",name:"",leader:"",mobile:"",sort:0,status:0},rules:{pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",trigger:["change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:["blur"]}]}})),V=()=>{U().then(t=>{_.value=E(t)})},E=t=>t.map(n=>{const p=n.children||[];return p.length&&E(p),n.id==r.value||n.status==0?n.disabled=!0:n.disabled=!1,n}),g=()=>{!r.value||(c.value=!0,x({id:r.value}).then(t=>{e.value=t}).finally(()=>{c.value=!1}))},A=()=>{var t;(t=v.value)==null||t.validate(l=>{if(!l)return;Array.isArray(e.value.pid)&&(e.value.pid=e.value.pid[e.value.pid.length-1]),(r.value?N({...e.value,id:r.value}):T(e.value)).then(()=>{setTimeout(()=>F.go(-1),500)})})};return z(()=>{g(),V()}),(t,l)=>{const n=d("el-page-header"),p=d("el-card"),h=d("el-cascader"),i=d("el-form-item"),m=d("el-input"),y=d("el-switch"),w=d("el-button"),k=H("loading");return D(),M(I,null,[a(p,{shadow:"never"},{default:s(()=>[a(n,{content:u(r)?"\u7F16\u8F91\u90E8\u95E8":"\u65B0\u589E\u90E8\u95E8",onBack:l[0]||(l[0]=o=>t.$router.back())},null,8,["content"])]),_:1}),O((D(),j(p,{shadow:"never",class:"m-t-15"},{default:s(()=>[a(u(G),{ref_key:"formRefs",ref:v,rules:u(B),class:"ls-form",model:u(e),"label-width":"150px"},{default:s(()=>[a(i,{label:"\u4E0A\u7EA7\u90E8\u95E8",prop:"pid"},{default:s(()=>[a(h,{modelValue:u(e).pid,"onUpdate:modelValue":l[1]||(l[1]=o=>u(e).pid=o),options:_.value,props:{value:"id",label:"name",checkStrictly:!0},clearable:"",disabled:u(e).pid===0&&u(r)},null,8,["modelValue","options","disabled"])]),_:1}),a(i,{label:"\u90E8\u95E8\u540D\u79F0",prop:"name"},{default:s(()=>[a(m,{modelValue:u(e).name,"onUpdate:modelValue":l[2]||(l[2]=o=>u(e).name=o),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u8D1F\u8D23\u4EBA",prop:"leader"},{default:s(()=>[a(m,{modelValue:u(e).leader,"onUpdate:modelValue":l[3]||(l[3]=o=>u(e).leader=o),placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA\u59D3\u540D"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"mobile"},{default:s(()=>[a(m,{modelValue:u(e).mobile,"onUpdate:modelValue":l[4]||(l[4]=o=>u(e).mobile=o),placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD",type:"tel"},null,8,["modelValue"])]),_:1}),a(i,{label:"\u6392\u5E8F",prop:"sort"},{default:s(()=>[a(m,{modelValue:u(e).sort,"onUpdate:modelValue":l[5]||(l[5]=o=>u(e).sort=o),placeholder:"\u8BF7\u8F93\u5165\u6392\u5E8F",type:"number"},null,8,["modelValue"]),P]),_:1}),a(i,{label:"\u90E8\u95E8\u72B6\u6001"},{default:s(()=>[a(y,{modelValue:u(e).status,"onUpdate:modelValue":l[6]||(l[6]=o=>u(e).status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1})),[[k,c.value]]),a(C,null,{default:s(()=>[a(w,{type:"primary",onClick:A},{default:s(()=>[Q]),_:1})]),_:1})],64)}}});export{ee as default};
