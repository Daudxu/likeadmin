import{a as _,E as V}from"./el-select.1d971f97.js";import{_ as E}from"./el-tree.47d5228f.js";import{bl as w,aa as M,a8 as $,bm as H,bn as q,at as G,bo as z,bp as D,P as J,a2 as L,e as C,N as T,d as F,M as Q,K as W,U as K,af as X,r as P,f as S,o as Y,bd as p,$ as Z}from"./index.c3aea19d.js";import{m as B,c as j,p as ee,l as ne}from"./isEqual.662af1fc.js";function te(e){return e}function le(e,n,l){switch(l.length){case 0:return e.call(n);case 1:return e.call(n,l[0]);case 2:return e.call(n,l[0],l[1]);case 3:return e.call(n,l[0],l[1],l[2])}return e.apply(n,l)}var re=800,ie=16,ae=Date.now;function ue(e){var n=0,l=0;return function(){var r=ae(),t=ie-(r-l);if(l=r,t>0){if(++n>=re)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}function se(e){return function(){return e}}var oe=w?function(e,n){return w(e,"toString",{configurable:!0,enumerable:!1,value:se(n),writable:!0})}:te;const ce=oe;var de=ue(ce);const fe=de;var A=Math.max;function he(e,n,l){return n=A(n===void 0?e.length-1:n,0),function(){for(var r=arguments,t=-1,a=A(r.length-n,0),i=Array(a);++t<a;)i[t]=r[n+t];t=-1;for(var s=Array(n+1);++t<n;)s[t]=r[t];return s[n]=l(i),le(e,this,s)}}var I=M?M.isConcatSpreadable:void 0;function ve(e){return $(e)||B(e)||!!(I&&e&&e[I])}function R(e,n,l,r,t){var a=-1,i=e.length;for(l||(l=ve),t||(t=[]);++a<i;){var s=e[a];n>0&&l(s)?n>1?R(s,n-1,l,r,t):j(t,s):r||(t[t.length]=s)}return t}function me(e){var n=e==null?0:e.length;return n?R(e,1):[]}function ye(e){return fe(he(e,void 0,me),e+"")}function Ce(e,n){return e!=null&&n in Object(e)}function ge(e,n,l){n=H(n,e);for(var r=-1,t=n.length,a=!1;++r<t;){var i=q(n[r]);if(!(a=e!=null&&l(e,i)))break;e=e[i]}return a||++r!=t?a:(t=e==null?0:e.length,!!t&&ee(t)&&G(i,t)&&($(e)||B(e)))}function ke(e,n){return e!=null&&ge(e,n,Ce)}function be(e,n,l){for(var r=-1,t=n.length,a={};++r<t;){var i=n[r],s=z(e,i);l(s,i)&&D(a,H(i,e),s)}return a}function xe(e,n){return be(e,n,function(l,r){return ke(e,r)})}var Ke=ye(function(e,n){return e==null?{}:xe(e,n)});const b=Ke,Se=(e,{attrs:n},{tree:l,key:r})=>{const t=J("tree-select"),a={...b(L(e),Object.keys(_.props)),...n,valueKey:r,popperClass:C(()=>{const i=[t.e("popper")];return e.popperClass&&i.push(e.popperClass),i.join(" ")}),filterMethod:(i="")=>{e.filterMethod&&e.filterMethod(i),T(()=>{var s;(s=l.value)==null||s.filter(i)})},onVisibleChange:i=>{var s;(s=n.onVisibleChange)==null||s.call(n,i),e.filterable&&i&&a.filterMethod()}};return a},Ne=F({extends:V,setup(e,n){const l=V.setup(e,n);delete l.selectOptionClick;const r=Q().proxy;return T(()=>{l.select.cachedOptions.get(r.value)||l.select.onOptionCreate(r)}),l},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function O(e){return e||e===0}function U(e){return Array.isArray(e)&&e.length}function N(e){return Array.isArray(e)?e:O(e)?[e]:[]}function g(e,n,l,r,t){for(let a=0;a<e.length;a++){const i=e[a];if(n(i,a,e,t))return r?r(i,a,e,t):i;{const s=l(i);if(U(s)){const o=g(s,n,l,r,i);if(o)return o}}}}const _e=(e,{attrs:n,slots:l,emit:r},{select:t,tree:a,key:i})=>{W(()=>e.modelValue,()=>{e.showCheckbox&&T(()=>{const u=a.value;u&&!ne(u.getCheckedKeys(),N(e.modelValue))&&u.setCheckedKeys(N(e.modelValue))})},{immediate:!0,deep:!0});const s=C(()=>({value:i.value,...e.props})),o=(u,c)=>{var d;const f=s.value[u];return X(f)?f(c,(d=a.value)==null?void 0:d.getNode(o("value",c))):c[f]},m=N(e.modelValue).map(u=>g(e.data||[],c=>o("value",c)===u,c=>o("children",c),(c,d,f,h)=>h&&o("value",h))).filter(u=>O(u));return{...b(L(e),Object.keys(E.props)),...n,nodeKey:i,expandOnClickNode:C(()=>!e.checkStrictly),defaultExpandedKeys:C(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(m):m),renderContent:(u,{node:c,data:d,store:f})=>u(Ne,{value:o("value",d),label:o("label",d),disabled:o("disabled",d)},e.renderContent?()=>e.renderContent(u,{node:c,data:d,store:f}):l.default?()=>l.default({node:c,data:d,store:f}):void 0),filterNodeMethod:(u,c,d)=>{var f;return e.filterNodeMethod?e.filterNodeMethod(u,c,d):u?(f=o("label",c))==null?void 0:f.includes(u):!0},onNodeClick:(u,c,d)=>{var f,h,y;if((f=n.onNodeClick)==null||f.call(n,u,c,d),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||c.isLeaf)){if(!o("disabled",u)){const x=(h=t.value)==null?void 0:h.options.get(o("value",u));(y=t.value)==null||y.handleOptionSelect(x,!0)}}else d.proxy.handleExpandIconClick()},onCheck:(u,c)=>{var d;(d=n.onCheck)==null||d.call(n,u,c);const f=o("value",u);if(e.checkStrictly)r(K,e.multiple?c.checkedKeys:c.checkedKeys.includes(f)?f:void 0);else if(e.multiple)r(K,a.value.getCheckedKeys(!0));else{const h=g([u],v=>!U(o("children",v))&&!o("disabled",v),v=>o("children",v)),y=h?o("value",h):void 0,x=O(e.modelValue)&&!!g([u],v=>o("value",v)===e.modelValue,v=>o("children",v));r(K,y===e.modelValue||x?void 0:y)}}}},Ee=F({name:"ElTreeSelect",inheritAttrs:!1,props:{..._.props,...E.props},setup(e,n){const{slots:l,expose:r}=n,t=P(),a=P(),i=C(()=>e.nodeKey||e.valueKey||"value"),s=Se(e,n,{select:t,tree:a,key:i}),o=_e(e,n,{select:t,tree:a,key:i}),m=S({});return r(m),Y(()=>{Object.assign(m,{...b(a.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...b(t.value,["focus","blur"])})}),()=>p(_,S({...s,ref:u=>t.value=u}),{...l,default:()=>p(E,S({...o,ref:u=>a.value=u}))})}});var k=Z(Ee,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);k.install=e=>{e.component(k.name,k)};const Oe=k,Pe=Oe;export{Pe as E};
