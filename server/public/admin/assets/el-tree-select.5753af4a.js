import{a as O,E as V}from"./el-select.8818cd12.js";import{_ as b}from"./el-tree.487a0a08.js";import{dK as p,dL as A,dM as $,aI as B,a4 as F,dN as R,dO as U,P as q,Z as I,k as C,K as T,d as L,N as G,L as X,ab as Z,r as M,l as N,m as z,bx as w,X as D}from"./index.4ed0f585.js";import{m as J,p as Q,l as W}from"./isEqual.4fe5ed00.js";import{b as Y}from"./_baseFlatten.f9f31f82.js";import{U as _}from"./event.776e7e11.js";function j(e){return e}function ee(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}var ne=800,te=16,le=Date.now;function re(e){var n=0,t=0;return function(){var i=le(),l=te-(i-t);if(t=i,l>0){if(++n>=ne)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}function ie(e){return function(){return e}}var ue=p?function(e,n){return p(e,"toString",{configurable:!0,enumerable:!1,value:ie(n),writable:!0})}:j,ae=ue,se=re(ae),oe=se,P=Math.max;function ce(e,n,t){return n=P(n===void 0?e.length-1:n,0),function(){for(var i=arguments,l=-1,a=P(i.length-n,0),r=Array(a);++l<a;)r[l]=i[n+l];l=-1;for(var c=Array(n+1);++l<n;)c[l]=i[l];return c[n]=t(r),ee(e,this,c)}}function de(e){var n=e==null?0:e.length;return n?Y(e,1):[]}function fe(e){return oe(ce(e,void 0,de),e+"")}function he(e,n){return e!=null&&n in Object(e)}function ve(e,n,t){n=A(n,e);for(var i=-1,l=n.length,a=!1;++i<l;){var r=$(n[i]);if(!(a=e!=null&&t(e,r)))break;e=e[r]}return a||++i!=l?a:(l=e==null?0:e.length,!!l&&J(l)&&B(r,l)&&(F(e)||Q(e)))}function me(e,n){return e!=null&&ve(e,n,he)}function ye(e,n,t){for(var i=-1,l=n.length,a={};++i<l;){var r=n[i],c=R(e,r);t(c,r)&&U(a,A(r,e),c)}return a}function Ce(e,n){return ye(e,n,function(t,i){return me(e,i)})}var ke=fe(function(e,n){return e==null?{}:Ce(e,n)}),K=ke;const ge=(e,{attrs:n},{tree:t,key:i})=>{const l=q("tree-select"),a={...K(I(e),Object.keys(O.props)),...n,valueKey:i,popperClass:C(()=>{const r=[l.e("popper")];return e.popperClass&&r.push(e.popperClass),r.join(" ")}),filterMethod:(r="")=>{e.filterMethod&&e.filterMethod(r),T(()=>{var c;(c=t.value)==null||c.filter(r)})},onVisibleChange:r=>{var c;(c=n.onVisibleChange)==null||c.call(n,r),e.filterable&&r&&a.filterMethod()}};return a},Ke=L({extends:V,setup(e,n){const t=V.setup(e,n);delete t.selectOptionClick;const i=G().proxy;return T(()=>{t.select.cachedOptions.get(i.value)||t.select.onOptionCreate(i)}),t},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function E(e){return e||e===0}function H(e){return Array.isArray(e)&&e.length}function S(e){return Array.isArray(e)?e:E(e)?[e]:[]}function k(e,n,t,i,l){for(let a=0;a<e.length;a++){const r=e[a];if(n(r,a,e,l))return i?i(r,a,e,l):r;{const c=t(r);if(H(c)){const s=k(c,n,t,i,r);if(s)return s}}}}const xe=(e,{attrs:n,slots:t,emit:i},{select:l,tree:a,key:r})=>{X(()=>e.modelValue,()=>{e.showCheckbox&&T(()=>{const u=a.value;u&&!W(u.getCheckedKeys(),S(e.modelValue))&&u.setCheckedKeys(S(e.modelValue))})},{immediate:!0,deep:!0});const c=C(()=>({value:r.value,...e.props})),s=(u,o)=>{var d;const f=c.value[u];return Z(f)?f(o,(d=a.value)==null?void 0:d.getNode(s("value",o))):o[f]},m=S(e.modelValue).map(u=>k(e.data||[],o=>s("value",o)===u,o=>s("children",o),(o,d,f,h)=>h&&s("value",h))).filter(u=>E(u));return{...K(I(e),Object.keys(b.props)),...n,nodeKey:r,expandOnClickNode:C(()=>!e.checkStrictly),defaultExpandedKeys:C(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(m):m),renderContent:(u,{node:o,data:d,store:f})=>u(Ke,{value:s("value",d),label:s("label",d),disabled:s("disabled",d)},e.renderContent?()=>e.renderContent(u,{node:o,data:d,store:f}):t.default?()=>t.default({node:o,data:d,store:f}):void 0),filterNodeMethod:(u,o,d)=>{var f;return e.filterNodeMethod?e.filterNodeMethod(u,o,d):u?(f=s("label",o))==null?void 0:f.includes(u):!0},onNodeClick:(u,o,d)=>{var f,h,y;if((f=n.onNodeClick)==null||f.call(n,u,o,d),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||o.isLeaf)){if(!s("disabled",u)){const x=(h=l.value)==null?void 0:h.options.get(s("value",u));(y=l.value)==null||y.handleOptionSelect(x,!0)}}else d.proxy.handleExpandIconClick()},onCheck:(u,o)=>{var d;(d=n.onCheck)==null||d.call(n,u,o);const f=s("value",u);if(e.checkStrictly)i(_,e.multiple?o.checkedKeys:o.checkedKeys.includes(f)?f:void 0);else if(e.multiple)i(_,a.value.getCheckedKeys(!0));else{const h=k([u],v=>!H(s("children",v))&&!s("disabled",v),v=>s("children",v)),y=h?s("value",h):void 0,x=E(e.modelValue)&&!!k([u],v=>s("value",v)===e.modelValue,v=>s("children",v));i(_,y===e.modelValue||x?void 0:y)}}}},Ne=L({name:"ElTreeSelect",inheritAttrs:!1,props:{...O.props,...b.props},setup(e,n){const{slots:t,expose:i}=n,l=M(),a=M(),r=C(()=>e.nodeKey||e.valueKey||"value"),c=ge(e,n,{select:l,tree:a,key:r}),s=xe(e,n,{select:l,tree:a,key:r}),m=N({});return i(m),z(()=>{Object.assign(m,{...K(a.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...K(l.value,["focus","blur"])})}),()=>w(O,N({...c,ref:u=>l.value=u}),{...t,default:()=>w(b,N({...s,ref:u=>a.value=u}))})}});var g=D(Ne,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);g.install=e=>{e.component(g.name,g)};const _e=g,pe=_e;export{pe as E};
