import{E as S,a as T}from"./el-select.bb7c2e43.js";import{_ as b}from"./el-tree.9d92b441.js";import{dH as V,dI as A,dJ as $,aI as B,a4 as F,dK as R,dL as U,P as q,Z as I,k as y,K as O,d as L,N as G,L as J,ab as X,r as w,l as x,m as Z,bx as M,X as z}from"./index.c1f325b4.js";import{m as D,p as Q,l as W}from"./isEqual.3ef07690.js";import{b as Y}from"./_baseFlatten.3d6951e9.js";import{U as K}from"./event.776e7e11.js";function j(e){return e}function ee(e,n,t){switch(t.length){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}var ne=800,te=16,le=Date.now;function re(e){var n=0,t=0;return function(){var i=le(),l=te-(i-t);if(t=i,l>0){if(++n>=ne)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}function ie(e){return function(){return e}}var oe=V?function(e,n){return V(e,"toString",{configurable:!0,enumerable:!1,value:ie(n),writable:!0})}:j,ae=oe,ue=re(ae),ce=ue,P=Math.max;function se(e,n,t){return n=P(n===void 0?e.length-1:n,0),function(){for(var i=arguments,l=-1,a=P(i.length-n,0),r=Array(a);++l<a;)r[l]=i[n+l];l=-1;for(var s=Array(n+1);++l<n;)s[l]=i[l];return s[n]=t(r),ee(e,this,s)}}function de(e){var n=e==null?0:e.length;return n?Y(e,1):[]}function fe(e){return ce(se(e,void 0,de),e+"")}function he(e,n){return e!=null&&n in Object(e)}function ve(e,n,t){n=A(n,e);for(var i=-1,l=n.length,a=!1;++i<l;){var r=$(n[i]);if(!(a=e!=null&&t(e,r)))break;e=e[r]}return a||++i!=l?a:(l=e==null?0:e.length,!!l&&D(l)&&B(r,l)&&(F(e)||Q(e)))}function me(e,n){return e!=null&&ve(e,n,he)}function ge(e,n,t){for(var i=-1,l=n.length,a={};++i<l;){var r=n[i],s=R(e,r);t(s,r)&&U(a,A(r,e),s)}return a}function ye(e,n){return ge(e,n,function(t,i){return me(e,i)})}var Ce=fe(function(e,n){return e==null?{}:ye(e,n)}),_=Ce;const ke=(e,{attrs:n},{tree:t,key:i})=>{const l=q("tree-select"),a={..._(I(e),Object.keys(S.props)),...n,valueKey:i,popperClass:y(()=>{const r=[l.e("popper")];return e.popperClass&&r.push(e.popperClass),r.join(" ")}),filterMethod:(r="")=>{e.filterMethod&&e.filterMethod(r),O(()=>{var s;(s=t.value)==null||s.filter(r)})},onVisibleChange:r=>{var s;(s=n.onVisibleChange)==null||s.call(n,r),e.filterable&&r&&a.filterMethod()}};return a},_e=L({extends:T,setup(e,n){const t=T.setup(e,n);delete t.selectOptionClick;const i=G().proxy;return O(()=>{t.select.cachedOptions.get(i.value)||t.select.onOptionCreate(i)}),t},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function E(e){return e||e===0}function H(e){return Array.isArray(e)&&e.length}function N(e){return Array.isArray(e)?e:E(e)?[e]:[]}function C(e,n,t,i,l){for(let a=0;a<e.length;a++){const r=e[a];if(n(r,a,e,l))return i?i(r,a,e,l):r;{const s=t(r);if(H(s)){const u=C(s,n,t,i,r);if(u)return u}}}}const pe=(e,{attrs:n,slots:t,emit:i},{select:l,tree:a,key:r})=>{J(()=>e.modelValue,()=>{e.showCheckbox&&O(()=>{const o=a.value;o&&!W(o.getCheckedKeys(),N(e.modelValue))&&o.setCheckedKeys(N(e.modelValue))})},{immediate:!0,deep:!0});const s=y(()=>({value:r.value,...e.props})),u=(o,c)=>{var d;const f=s.value[o];return X(f)?f(c,(d=a.value)==null?void 0:d.getNode(u("value",c))):c[f]},m=N(e.modelValue).map(o=>C(e.data||[],c=>u("value",c)===o,c=>u("children",c),(c,d,f,h)=>h&&u("value",h))).filter(o=>E(o));return{..._(I(e),Object.keys(b.props)),...n,nodeKey:r,expandOnClickNode:y(()=>!e.checkStrictly),defaultExpandedKeys:y(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(m):m),renderContent:(o,{node:c,data:d,store:f})=>o(_e,{value:u("value",d),label:u("label",d),disabled:u("disabled",d)},e.renderContent?()=>e.renderContent(o,{node:c,data:d,store:f}):t.default?()=>t.default({node:c,data:d,store:f}):void 0),filterNodeMethod:(o,c,d)=>{var f;return e.filterNodeMethod?e.filterNodeMethod(o,c,d):o?(f=u("label",c))==null?void 0:f.includes(o):!0},onNodeClick:(o,c,d)=>{var f,h,g;if((f=n.onNodeClick)==null||f.call(n,o,c,d),!(e.showCheckbox&&e.checkOnClickNode))if(!e.showCheckbox&&(e.checkStrictly||c.isLeaf)){if(!u("disabled",o)){const p=(h=l.value)==null?void 0:h.options.get(u("value",o));(g=l.value)==null||g.handleOptionSelect(p,!0)}}else d.proxy.handleExpandIconClick()},onCheck:(o,c)=>{var d;(d=n.onCheck)==null||d.call(n,o,c);const f=u("value",o);if(e.checkStrictly)i(K,e.multiple?c.checkedKeys:c.checkedKeys.includes(f)?f:void 0);else if(e.multiple)i(K,a.value.getCheckedKeys(!0));else{const h=C([o],v=>!H(u("children",v))&&!u("disabled",v),v=>u("children",v)),g=h?u("value",h):void 0,p=E(e.modelValue)&&!!C([o],v=>u("value",v)===e.modelValue,v=>u("children",v));i(K,g===e.modelValue||p?void 0:g)}}}},xe=L({name:"ElTreeSelect",inheritAttrs:!1,props:{...S.props,...b.props},setup(e,n){const{slots:t,expose:i}=n,l=w(),a=w(),r=y(()=>e.nodeKey||e.valueKey||"value"),s=ke(e,n,{select:l,tree:a,key:r}),u=pe(e,n,{select:l,tree:a,key:r}),m=x({});return i(m),Z(()=>{Object.assign(m,{..._(a.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),..._(l.value,["focus","blur"])})}),()=>M(S,x({...s,ref:o=>l.value=o}),{...t,default:()=>M(b,x({...u,ref:o=>a.value=o}))})}});var k=z(xe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);k.install=e=>{e.component(k.name,k)};const Ke=k,Ve=Ke;export{Ve as E};
