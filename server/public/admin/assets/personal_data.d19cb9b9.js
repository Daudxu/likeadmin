import{_ as E}from"./index.b6938fb2.js";import{F as A}from"./index.319a77f2.js";import{a as C,b as g}from"./setting.4f3d8e6f.js";import{d as V,k as y,r as i,m as D,n as b,e as d,o as h,c as M,a,w as l,h as U,bF as r}from"./index.6235ba03.js";import"./index.a594d598.js";import"./index.9923ef6e.js";import"./pages.9569697b.js";const k={class:"personal-data"},x=U("\u4FDD\u5B58"),G=V({__name:"personal_data",setup(S){const{store:f}=y(),p=i(),u=i({avatar:"",account:"",name:"",password_old:"",password:"",password_confirm:""}),F=D({avatar:[{required:!0,message:"\u5934\u50CF\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]}),m=async()=>{u.value=await C()},_=async()=>{if(u.value.password_old||u.value.password||u.value.password_confirm){if(!u.value.password_old)return r({type:"error",message:"\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801"});if(!u.value.password)return r({type:"error",message:"\u8BF7\u8F93\u5165\u65B0\u7684\u5BC6\u7801"});if(!u.value.password_confirm)return r({type:"error",message:"\u8BF7\u8F93\u5165\u786E\u5B9A\u5BC6\u7801"});if(u.value.password_confirm!=u.value.password)return r({type:"error",message:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u6837"})}if(u.value.password_old&&u.value.password&&u.value.password_confirm){if(u.value.password_old.length<6||u.value.password_old.length>32)return r({type:"error",message:"\u5BC6\u7801\u957F\u5EA6\u57286\u523032\u4E4B\u95F4"});if(u.value.password.length<6||u.value.password.length>32)return r({type:"error",message:"\u5BC6\u7801\u957F\u5EA6\u57286\u523032\u4E4B\u95F4"});if(u.value.password_confirm.length<6||u.value.password_confirm.length>32)return r({type:"error",message:"\u5BC6\u7801\u957F\u5EA6\u57286\u523032\u4E4B\u95F4"})}await g({...u.value}),m(),f.dispatch("user/getUser")},v=n=>{!n||n.validate(e=>{if(!e)return!1;_()})};return b(()=>{m()}),(n,e)=>{const s=d("el-form-item"),t=d("el-input"),w=d("el-form"),c=d("el-card"),B=d("el-button");return h(),M("div",k,[a(c,{class:"m-t-15",shadow:"never"},{default:l(()=>[a(w,{ref_key:"formRefs",ref:p,class:"ls-form",model:u.value,rules:F,"label-width":"150px"},{default:l(()=>[a(s,{label:"\u5934\u50CF\uFF1A",prop:"avatar"},{default:l(()=>[a(E,{modelValue:u.value.avatar,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value.avatar=o),limit:1},null,8,["modelValue"])]),_:1}),a(s,{label:"\u8D26\u53F7\uFF1A",prop:"account"},{default:l(()=>[a(t,{modelValue:u.value.account,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value.account=o),placeholder:"",disabled:""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:l(()=>[a(t,{modelValue:u.value.name,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value.name=o),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u5F53\u524D\u5BC6\u7801\uFF1A",prop:"password_old"},{default:l(()=>[a(t,{modelValue:u.value.password_old,"onUpdate:modelValue":e[3]||(e[3]=o=>u.value.password_old=o),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u65B0\u7684\u5BC6\u7801\uFF1A",prop:"password"},{default:l(()=>[a(t,{modelValue:u.value.password,"onUpdate:modelValue":e[4]||(e[4]=o=>u.value.password=o),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(s,{label:"\u786E\u5B9A\u5BC6\u7801\uFF1A",prop:"password_confirm"},{default:l(()=>[a(t,{modelValue:u.value.password_confirm,"onUpdate:modelValue":e[5]||(e[5]=o=>u.value.password_confirm=o),modelModifiers:{trim:!0},placeholder:"\u4FEE\u6539\u5BC6\u7801\u65F6\u5FC5\u586B, \u4E0D\u4FEE\u6539\u5BC6\u7801\u65F6\u7559\u7A7A",type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),a(A,null,{default:l(()=>[a(B,{type:"primary",onClick:e[6]||(e[6]=o=>v(p.value))},{default:l(()=>[x]),_:1})]),_:1})])}}});export{G as default};
