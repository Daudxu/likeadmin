import{x as H,y as O,W,B as $,U as j,A as z,E as G,M as J}from"./element-plus.32724f3c.js";import{a as Q,b as X}from"./role.7e5baca5.js";import{m as Y}from"./menu.6914673d.js";import{P as Z}from"./index.e971c32f.js";import{t as ee}from"./index.3da0cb60.js";import{d as le,s as v,r,e as te,$ as oe,o as C,c as b,U as t,L as d,M as ae,a as c,u as se,n as E}from"./@vue.67e62321.js";const ue={class:"edit-popup"},ne={class:"h-[400px]"},de={class:"w-80"},re={class:"w-80"},he=le({__name:"edit",emits:["success","close"],setup(ce,{expose:x,emit:h}){const u=v(),y=v(),i=v(),p=r("add"),F=r(!1),g=r(!1),m=r(!0),k=r([]),f=r([]),V=te(()=>p.value=="edit"?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"),o=oe({id:"",name:"",desc:"",sort:0,menu_id:[]}),w={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},D=()=>{Y({page_type:0}).then(l=>{f.value=l.lists,k.value=ee(l.lists),E(()=>{A()})})},B=()=>{var a,s;const l=(a=u.value)==null?void 0:a.getCheckedKeys(),e=(s=u.value)==null?void 0:s.getHalfCheckedKeys();return l==null||l.unshift.apply(l,e),l},A=()=>{o.menu_id.forEach(l=>{E(()=>{var e;(e=u.value)==null||e.setChecked(l,!0,!1)})})},R=l=>{const e=f.value;for(let a=0;a<e.length;a++)u.value.store.nodesMap[e[a].id].expanded=l},K=l=>{var e,a;l?(e=u.value)==null||e.setCheckedKeys(k.value.map(s=>s.id)):(a=u.value)==null||a.setCheckedKeys([])},U=async()=>{var l,e;await((l=y.value)==null?void 0:l.validate()),o.menu_id=B(),p.value=="edit"?await Q(o):await X(o),(e=i.value)==null||e.close(),h("success")},T=()=>{h("close")},L=(l="add")=>{var e;p.value=l,(e=i.value)==null||e.open()},M=async l=>{for(const e in o)l[e]!=null&&l[e]!=null&&(o[e]=l[e])};return D(),x({open:L,setFormData:M}),(l,e)=>{const a=H,s=O,S=W,_=$,I=j,N=z,P=G,q=J;return C(),b("div",ue,[t(Z,{ref_key:"popupRef",ref:i,title:se(V),async:!0,width:"600px",clickModalClose:!0,onConfirm:U,onClose:T},{default:d(()=>[ae((C(),b("div",ne,[t(P,null,{default:d(()=>[t(N,{class:"ls-form",ref_key:"formRef",ref:y,rules:w,model:o,"label-width":"80px"},{default:d(()=>[t(s,{label:"\u540D\u79F0",prop:"name"},{default:d(()=>[c("div",de,[t(a,{class:"ls-input",modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.name=n),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])])]),_:1}),t(s,{label:"\u5907\u6CE8",prop:"desc"},{default:d(()=>[c("div",re,[t(a,{modelValue:o.desc,"onUpdate:modelValue":e[1]||(e[1]=n=>o.desc=n),type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])])]),_:1}),t(s,{label:"\u6392\u5E8F",prop:"sort"},{default:d(()=>[t(S,{modelValue:o.sort,"onUpdate:modelValue":e[2]||(e[2]=n=>o.sort=n)},null,8,["modelValue"])]),_:1}),t(s,{label:"\u6743\u9650",prop:"menu_id"},{default:d(()=>[c("div",null,[t(_,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:R}),t(_,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:K}),t(_,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=n=>m.value=n),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),c("div",null,[t(I,{ref_key:"treeRef",ref:u,data:f.value,props:{label:"name",children:"children"},"check-strictly":!m.value,"node-key":"id","default-expand-all":g.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1},8,["model"])]),_:1})])),[[q,F.value]])]),_:1},8,["title"])])}}});export{he as _};
