import{x as N,y as S,B as M,U as P,W as q,A as H}from"./element-plus.32724f3c.js";import{a as O,b as W}from"./role.d34b1a95.js";import{m as $}from"./menu.c8003463.js";import{P as j}from"./index.f5b35b1c.js";import{t as z}from"./index.e62a9b83.js";import{d as G,s as _,r as d,e as J,$ as Q,o as X,c as Y,U as o,L as r,a as k,u as Z,n as C}from"./@vue.67e62321.js";const ee={class:"edit-popup"},re=G({__name:"edit",emits:["success","close"],setup(le,{expose:b,emit:h}){const s=_(),v=_(),c=_(),p=d("add"),E=d(!1),m=d(!0),y=d([]),i=d([]),x=J(()=>p.value=="edit"?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"),t=Q({id:"",name:"",desc:"",sort:0,menu_id:[]}),F={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},V=()=>{$({page_type:0}).then(l=>{i.value=l.lists,y.value=z(l.lists),C(()=>{D()})})},g=()=>{var a,u;const l=(a=s.value)==null?void 0:a.getCheckedKeys(),e=(u=s.value)==null?void 0:u.getHalfCheckedKeys();return l==null||l.unshift.apply(l,e),l},D=()=>{t.menu_id.forEach(l=>{C(()=>{var e;(e=s.value)==null||e.setChecked(l,!0,!1)})})},w=l=>{const e=i.value;for(let a=0;a<e.length;a++)s.value.store.nodesMap[e[a].id].expanded=l},B=l=>{var e,a;l?(e=s.value)==null||e.setCheckedKeys(y.value.map(u=>u.id)):(a=s.value)==null||a.setCheckedKeys([])},A=async()=>{var l,e;await((l=v.value)==null?void 0:l.validate()),t.menu_id=g(),p.value=="edit"?await O(t):await W(t),(e=c.value)==null||e.close(),h("success")},R=()=>{h("close")},K=(l="add")=>{var e;p.value=l,(e=c.value)==null||e.open()},U=async l=>{for(const e in t)l[e]!=null&&l[e]!=null&&(t[e]=l[e])};return V(),b({open:K,setFormData:U}),(l,e)=>{const a=N,u=S,f=M,T=P,I=q,L=H;return X(),Y("div",ee,[o(j,{ref_key:"popupRef",ref:c,title:Z(x),async:!0,width:"600px",clickModalClose:!0,onConfirm:A,onClose:R},{default:r(()=>[o(L,{class:"ls-form",ref_key:"formRef",ref:v,rules:F,model:t,"label-width":"60px"},{default:r(()=>[o(u,{label:"\u540D\u79F0",prop:"name"},{default:r(()=>[o(a,{class:"ls-input",modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=n=>t.name=n),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u6743\u9650",prop:"menu_id"},{default:r(()=>[k("div",null,[o(f,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:w}),o(f,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:B}),o(f,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=n=>m.value=n),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),k("div",null,[o(T,{ref_key:"treeRef",ref:s,data:i.value,props:{label:"name",children:"children"},"check-strictly":!m.value,"node-key":"id","default-expand-all":E.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1}),o(u,{label:"\u5907\u6CE8",prop:"desc"},{default:r(()=>[o(a,{modelValue:t.desc,"onUpdate:modelValue":e[2]||(e[2]=n=>t.desc=n),type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1}),o(u,{label:"\u6392\u5E8F",prop:"sort"},{default:r(()=>[o(I,{modelValue:t.sort,"onUpdate:modelValue":e[3]||(e[3]=n=>t.sort=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{re as _};
