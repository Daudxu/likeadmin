import{x as q,y as H,W,B as j,U as z,A as G,E as J,M as Q}from"./element-plus.1a139bf1.js";import{a as X,b as Y}from"./role.cf9799b5.js";import{m as Z}from"./menu.44e1e4ee.js";import{P as $}from"./index.aabb1301.js";import{t as ee}from"./index.e1163f9a.js";import{d as le,s as v,r,e as te,a0 as oe,o as C,c as b,V as t,M as d,O as ae,a as c,u as se,n as E}from"./@vue.96b5b8e0.js";const ue={class:"edit-popup"},ne={class:"h-[400px]"},de={class:"w-80"},re={class:"w-80"},he=le({__name:"edit",emits:["success","close"],setup(ce,{expose:x,emit:h}){const u=v(),y=v(),i=v(),p=r("add"),F=r(!1),V=r(!1),m=r(!0),k=r([]),f=r([]),g=te(()=>p.value=="edit"?"\u7F16\u8F91\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"),o=oe({id:"",name:"",desc:"",sort:0,menu_id:[]}),w={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}]},D=()=>{Z({page_type:0}).then(l=>{f.value=l.lists,k.value=ee(l.lists),E(()=>{A()})})},B=()=>{var a,s;const l=(a=u.value)==null?void 0:a.getCheckedKeys(),e=(s=u.value)==null?void 0:s.getHalfCheckedKeys();return l==null||l.unshift.apply(l,e),l},A=()=>{o.menu_id.forEach(l=>{E(()=>{var e;(e=u.value)==null||e.setChecked(l,!0,!1)})})},R=l=>{const e=f.value;for(let a=0;a<e.length;a++)u.value.store.nodesMap[e[a].id].expanded=l},K=l=>{var e,a;l?(e=u.value)==null||e.setCheckedKeys(k.value.map(s=>s.id)):(a=u.value)==null||a.setCheckedKeys([])},T=async()=>{var l,e;await((l=y.value)==null?void 0:l.validate()),o.menu_id=B(),p.value=="edit"?await X(o):await Y(o),(e=i.value)==null||e.close(),h("success")},U=()=>{h("close")},M=(l="add")=>{var e;p.value=l,(e=i.value)==null||e.open()},S=async l=>{for(const e in o)l[e]!=null&&l[e]!=null&&(o[e]=l[e])};return D(),x({open:M,setFormData:S}),(l,e)=>{const a=q,s=H,I=W,_=j,L=z,N=G,O=J,P=Q;return C(),b("div",ue,[t($,{ref_key:"popupRef",ref:i,title:se(g),async:!0,width:"600px",clickModalClose:!0,onConfirm:T,onClose:U},{default:d(()=>[ae((C(),b("div",ne,[t(O,null,{default:d(()=>[t(N,{class:"ls-form",ref_key:"formRef",ref:y,rules:w,model:o,"label-width":"80px"},{default:d(()=>[t(s,{label:"\u540D\u79F0",prop:"name"},{default:d(()=>[c("div",de,[t(a,{class:"ls-input",modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.name=n),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])])]),_:1}),t(s,{label:"\u5907\u6CE8",prop:"desc"},{default:d(()=>[c("div",re,[t(a,{modelValue:o.desc,"onUpdate:modelValue":e[1]||(e[1]=n=>o.desc=n),type:"textarea",rows:4,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])])]),_:1}),t(s,{label:"\u6392\u5E8F",prop:"sort"},{default:d(()=>[t(I,{modelValue:o.sort,"onUpdate:modelValue":e[2]||(e[2]=n=>o.sort=n)},null,8,["modelValue"])]),_:1}),t(s,{label:"\u6743\u9650",prop:"menu_id"},{default:d(()=>[c("div",null,[t(_,{label:"\u5C55\u5F00/\u6298\u53E0",onChange:R}),t(_,{label:"\u5168\u9009/\u4E0D\u5168\u9009",onChange:K}),t(_,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=n=>m.value=n),label:"\u7236\u5B50\u8054\u52A8"},null,8,["modelValue"]),c("div",null,[t(L,{ref_key:"treeRef",ref:u,data:f.value,props:{label:"name",children:"children"},"check-strictly":!m.value,"node-key":"id","default-expand-all":V.value,"show-checkbox":""},null,8,["data","check-strictly","default-expand-all"])])])]),_:1})]),_:1},8,["model"])]),_:1})])),[[P,F.value]])]),_:1},8,["title"])])}}});export{he as _};
