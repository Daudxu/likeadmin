import{P as I}from"./index.04b9b699.js";import{E as N}from"./element-plus.81dd3128.js";import{F as T,_ as E,a as M}from"./index.e7213e6b.js";import{u as J,d as O,b as Q}from"./index.69f70f99.js";import{_ as W}from"./index.edda3007.js";import{D as j}from"./vuedraggable.f1b552bb.js";import{d as q,r as i,a5 as G,e as S,w as H,E as P,n as K,a6 as U,o as X,c as Y,W as n,aa as Z,O as p,a as s,R as V,$ as k,P as x,Q as ee,J as ae,a0 as le,U as oe,b9 as te,b8 as se}from"./@vue.af680e04.js";const ie=q({components:{Popup:I,Draggable:j,FileItem:T,Material:E,Preview:M},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:o}){const h=i(),g=i(),_=i(""),w=i(!1),l=i([]),m=i([]),r=i(!0),c=i(-1),{disabled:y,limit:u,modelValue:C}=G(e),{getImageUrl:b}=J(),t=S(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),f=S(()=>e.limit-l.value.length>0),v=S(()=>r.value?u.value==-1?null:u.value-l.value.length:1),D=()=>{const a=m.value.map(d=>e.excludeDomain?d.url:d.uri);r.value?l.value=[...l.value,...a]:l.value.splice(c.value,1,a.shift()),$()},A=a=>{var d;y.value||(a>=0?(r.value=!1,c.value=a):r.value=!0,(d=h.value)==null||d.open())},R=a=>{m.value=a},$=()=>{const a=u.value!=1?l.value:l.value[0]||"";o("update:modelValue",a),o("change",a),z()},F=a=>{l.value.splice(a,1),$()},L=a=>{_.value=a,w.value=!0},z=()=>{K(()=>{var a;e.hiddenUpload&&(l.value=[]),(a=g.value)==null||a.clearSelect()})};return H(C,a=>{l.value=Array.isArray(a)?a:a==""?[]:[a]},{immediate:!0}),P("limit",e.limit),P("hiddenUpload",e.hiddenUpload),{popupRef:h,materialRef:g,fileList:l,tipsText:t,handleConfirm:D,meterialLimit:v,showUpload:f,showPopup:A,selectChange:R,deleteImg:F,previewUrl:_,showPreview:w,handlePreview:L,handleClose:z,getImageUrl:b}}});const B=e=>(te("data-v-0f3a81e3"),e=e(),se(),e),ne={class:"material-select"},re=["onClick"],ue={class:"operation-btns text-xs text-center"},de=B(()=>s("span",null,"\u4FEE\u6539",-1)),pe=oe(" | "),me=["onClick"],ce=B(()=>s("span",null,"\u6DFB\u52A0",-1)),fe={class:"material-wrap"};function ve(e,o,h,g,_,w){const l=U("file-item"),m=W,r=U("draggable"),c=Q,y=E,u=N,C=I,b=U("preview");return X(),Y("div",ne,[n(C,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Z({default:p(()=>[n(u,null,{default:p(()=>[s("div",fe,[n(y,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:p(()=>[s("div",{class:"material-select__trigger clearfix",onClick:o[2]||(o[2]=k(()=>{},["stop"]))},[n(r,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":o[0]||(o[0]=t=>e.fileList=t),animation:"300","item-key":"id"},{item:p(({element:t,index:f})=>[s("div",{class:V(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:v=>e.showPopup(f)},[n(m,{onClose:v=>e.deleteImg(f)},{default:p(()=>[n(l,{uri:e.excludeDomain?e.getImageUrl(t):t,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),s("div",ue,[de,pe,s("span",{onClick:k(v=>e.handlePreview(t),["stop"])},"\u67E5\u770B",8,me)])],10,re)]),_:1},8,["modelValue"]),x(s("div",{class:V(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:o[1]||(o[1]=t=>e.showPopup(-1))},[ae(e.$slots,"upload",{},()=>[s("div",{class:"upload-btn",style:le({width:e.size,height:e.size})},[n(c,{size:25,name:"el-icon-Plus"}),ce],4)],!0)],2),[[ee,e.showUpload]])])])}]),1032,["title","onConfirm","onClose"]),n(b,{modelValue:e.showPreview,"onUpdate:modelValue":o[3]||(o[3]=t=>e.showPreview=t),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const Se=O(ie,[["render",ve],["__scopeId","data-v-0f3a81e3"]]);export{Se as _};
