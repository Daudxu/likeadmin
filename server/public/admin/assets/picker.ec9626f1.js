import{P as k}from"./index.e6077264.js";import{D as R}from"./element-plus.34a22242.js";import{F as N,_ as I,a as T,b as M}from"./index.e37c442c.js";import{_ as H}from"./index.vue_vue_type_script_lang.c17b493f.js";import{D as O}from"./vuedraggable.9f535ba0.js";import{d as Z,r as i,a3 as j,e as S,w as q,D as V,n as G,a4 as z,o as J,c as K,U as n,af as Q,L as u,a as s,P as $,Z as U,M as W,O as X,H as Y,_ as x,S as ee,b7 as le,b6 as oe}from"./@vue.10616dc1.js";import{_ as te}from"./_plugin-vue_export-helper.cdc0426e.js";const ae=Z({components:{Popup:k,Draggable:O,FileItem:N,Material:I,Preview:T},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:t}){const _=i(),h=i(),g=i(""),w=i(!1),o=i([]),p=i([]),r=i(!0),m=i(-1),{disabled:y,limit:d,modelValue:C}=j(e),b=S(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),a=S(()=>e.limit-o.value.length>0),c=S(()=>r.value?d.value?d.value-o.value.length:null:1),f=()=>{const l=p.value.map(v=>v.uri);r.value?o.value=[...o.value,...l]:o.value.splice(m.value,1,l.shift()),P()},E=l=>{var v;y.value||(l>=0?(r.value=!1,m.value=l):r.value=!0,(v=_.value)==null||v.open())},D=l=>{p.value=l},P=()=>{const l=d.value!=1?o.value:o.value[0]||"";t("update:modelValue",l),t("change",l)},L=l=>{o.value.splice(l,1),P()},A=l=>{g.value=l,w.value=!0},F=()=>{G(()=>{var l;(l=h.value)==null||l.clearSelect()})};return q(C,l=>{console.log(l),o.value=Array.isArray(l)?l:l==""?[]:[l]},{immediate:!0}),V("limit",e.limit),V("hiddenUpload",e.hiddenUpload),{popupRef:_,materialRef:h,fileList:o,tipsText:b,handleConfirm:f,meterialLimit:c,showUpload:a,showPopup:E,selectChange:D,deleteImg:L,previewUrl:g,showPreview:w,handlePreview:A,handleClose:F}}});const B=e=>(le("data-v-4acfd260"),e=e(),oe(),e),se={class:"material-select"},ie=["onClick"],ne={class:"operation-btns text-xs text-center"},re=B(()=>s("span",null,"\u4FEE\u6539",-1)),de=ee(" | "),ue=["onClick"],pe=B(()=>s("span",null,"\u6DFB\u52A0",-1)),me={class:"material-wrap"};function ce(e,t,_,h,g,w){const o=z("file-item"),p=M,r=z("draggable"),m=H,y=I,d=R,C=k,b=z("preview");return J(),K("div",se,[n(C,{ref:"popupRef",width:"950px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Q({default:u(()=>[n(d,null,{default:u(()=>[s("div",me,[n(y,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:u(()=>[s("div",{class:"material-select__trigger clearfix",onClick:t[2]||(t[2]=U(()=>{},["stop"]))},[n(r,{class:"draggable",modelValue:e.fileList,"onUpdate:modelValue":t[0]||(t[0]=a=>e.fileList=a),animation:"300","item-key":"id"},{item:u(({element:a,index:c})=>[s("div",{class:$(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:f=>e.showPopup(c)},[n(p,{onClose:f=>e.deleteImg(c)},{default:u(()=>[n(o,{uri:a,"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),s("div",ne,[re,de,s("span",{onClick:U(f=>e.handlePreview(a),["stop"])},"\u67E5\u770B",8,ue)])],10,ie)]),_:1},8,["modelValue"]),W(s("div",{class:$(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:t[1]||(t[1]=a=>e.showPopup(-1))},[Y(e.$slots,"upload",{},()=>[s("div",{class:"upload-btn",style:x({width:e.size,height:e.size})},[n(m,{size:25,name:"el-icon-Plus"}),pe],4)],!0)],2),[[X,e.showUpload]])])])}]),1032,["title","onConfirm","onClose"]),n(b,{modelValue:e.showPreview,"onUpdate:modelValue":t[3]||(t[3]=a=>e.showPreview=a),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const Ce=te(ae,[["render",ce],["__scopeId","data-v-4acfd260"]]);export{Ce as _};
