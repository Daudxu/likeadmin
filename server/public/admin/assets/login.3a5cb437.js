import{_ as E,d as V,j as C,r as p,k as A,l as K,m as L,n as b,A as w,p as $,E as q,c as D,e as l,q as I,t as v,a as n,w as r,s as y,o as N,v as k,g as R}from"./index.4026a001.js";import{E as U}from"./el-checkbox.34358670.js";import{E as x,a as z}from"./el-form-item.7b391b3d.js";import{E as S}from"./el-input.50f2552f.js";import"./event.776e7e11.js";import"./isEqual.29c8a120.js";import"./index.8e8fe03c.js";const T=V({setup(){const{store:e,router:t,route:F}=C(),f=p(null),_=p(null),c=p(!1),u=p(!1),i=A(()=>e.getters.config),a=K({account:"",password:""}),d={account:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:["blur"]}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:["blur"]}]},g=()=>{var o;if(!a.password)return(o=f.value)==null?void 0:o.focus();m()},m=()=>{var o;(o=_.value)==null||o.validate(h=>{!h||(u.value=!0,b.set(w,{remember:c.value,account:a.account}),e.dispatch("user/login",a).then(()=>{const{query:{redirect:s}}=F,B=typeof s=="string"?s:"/";t.replace(B)}).catch(s=>{console.log(s)}).finally(()=>{u.value=!1}))})};return L(()=>{const o=b.get(w);o.remember&&(c.value=o.remember,a.account=o.account)}),{config:i,passwordRefs:f,loginFormRefs:_,loginForm:a,loginLoading:u,rules:d,handleEnter:g,handleLogin:m,remAccount:c}}}),j={class:"login flex flex-col"},M={class:"flex-1 flex flex-center"},O={class:"login-card bg-white flex"},G={class:"login-form flex flex-col"},H={class:"f-s-24 f-w-500 text-center m-b-40"},J={class:"m-b-20"},P=R("\u767B\u5F55"),Q={class:"login-footer"},W={class:"flex flex-center muted xs m-t-20"},X={class:"m-r-10"},Y=["href"];function Z(e,t,F,f,_,c){const u=y("avatar"),i=$,a=S,d=x,g=y("lock"),m=z,o=U,h=q;return N(),D("div",j,[l("div",M,[l("div",O,[l("div",{class:"login-img",style:I({"background-image":`url(${e.config.login_image})`})},null,4),l("div",G,[l("div",H,v(e.config.web_name),1),n(m,{ref:"loginFormRefs",model:e.loginForm,"status-icon":"",rules:e.rules,size:"large"},{default:r(()=>[n(d,{prop:"account"},{default:r(()=>[n(a,{modelValue:e.loginForm.account,"onUpdate:modelValue":t[0]||(t[0]=s=>e.loginForm.account=s),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",onKeyup:k(e.handleEnter,["enter"])},{prepend:r(()=>[n(i,null,{default:r(()=>[n(u)]),_:1})]),_:1},8,["modelValue","onKeyup"])]),_:1}),n(d,{prop:"password"},{default:r(()=>[n(a,{ref:"passwordRefs",modelValue:e.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=s=>e.loginForm.password=s),"show-password":"",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",onKeyup:k(e.handleLogin,["enter"])},{prepend:r(()=>[n(i,null,{default:r(()=>[n(g)]),_:1})]),_:1},8,["modelValue","onKeyup"])]),_:1})]),_:1},8,["model","rules"]),l("div",J,[n(o,{modelValue:e.remAccount,"onUpdate:modelValue":t[2]||(t[2]=s=>e.remAccount=s),label:"\u8BB0\u4F4F\u8D26\u53F7"},null,8,["modelValue"])]),n(h,{type:"primary",loading:e.loginLoading,onClick:e.handleLogin,size:"large"},{default:r(()=>[P]),_:1},8,["loading","onClick"])])])]),l("div",Q,[l("div",W,[l("span",X,v(e.config.copyright_info),1),l("a",{class:"link muted",href:e.config.icp_link,target:"_blank"},v(e.config.icp_number),9,Y)])])])}var re=E(T,[["render",Z],["__scopeId","data-v-d6678c4a"]]);export{re as default};
